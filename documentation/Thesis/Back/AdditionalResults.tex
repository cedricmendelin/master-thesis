% !TEX root = ../Thesis.tex

\chapter{Additional Results}
In this chapter, additional numeric and visual results are presented, that shall
extend results presented in Chapter~\ref{sec:results}.

\section{Small Scale Experiment: GAT-Denoiser Components}

Table~\ref{tab:small_gat_components} shows numerical results for the small scale experiment.
Results for the baseline algorithms, different models with $k=2$ and $k=8$ are presented.  
\begin{table}[H]
    \centering
    \begin{tabular}{l|c|c|c|c}
      \toprule
      \textbf{Algorithm} & \snrh{ 0} & \snrh{ -5} & \snrh{ -10} & \snrh{ -15} \\
                         & \textbf{SNR} & \textbf{SNR} & \textbf{SNR}  & \textbf{SNR} \\ 
      \midrule
      FBP                 & 4.50 & -0.31  & -5.25 & -10.22  \\ \hline
      BM3D sino           & 9.93 &  7.42  & 4.61  & 2.00    \\ \hline
      BM3D reco           & 10.79 & 8.09  & 4.97  & 1.54    \\ \hline
      U-Net               & 7.13  &  6.18 & 4.34  & 1.87    \\ \hline
      \midrule
      \multicolumn{5}{c}{K-NN k = 2} \\
      GAT             &	9.42 	&8.25	&6.78	&5.75  \\  \hline
      Conv+GAT        & 10.01 &8.88	&7.69	&6.79  \\ \hline
      GAT+U-Net       &	7.93	&7.28	&6.77	&4.91  \\ \hline
      GAT+U-Net*      &	11.92	&10.14	&10.13	&8.43 \\ \hline
      GAT+U-Net**     &	13.41	&12.12	&10.62	&8.50  \\ \hline
      Conv+GAT+U-Net  &	8.17	&7.09	&4.53	&5.67  \\ \hline
      Conv+GAT+U-Net* &	12.60	&10.71	&8.80	&8.44  \\ \hline
      Conv+GAT+U-Net**&	12.80	&11.70	&10.63	&9.21 \\ \hline
      
      \midrule
      \multicolumn{5}{c}{K-NN k = 8} \\
      GAT                  & 8.32           & 6.94           & 6.19 & 5.01 \\ \hline
      Conv + GAT           & 9.05           & 8.07           & 6.99  & 5.75 \\ \hline
      GAT + U-Net          & 7.49           & 6.40           & 6.01   & 5.07 \\ \hline
      GAT + U-Net**        & 11.88          & \textbf{10.85} & \textbf{9.68} & \textbf{8.26} \\ \hline
      Conv + GAT + U-Net   & 7.55           & 6.50           &5.74 &4.87 \\ \hline
      Conv + GAT + U-Net** & \textbf{11.94} & 10.31          &7.34   &7.33 \\ \hline
    
    \end{tabular}
    \legend{The evaluated GAT-Denoiser models have been trained with 1024 images for 200 epochs. 
    U-Net* refers to joint U-Net training and U-Net** to joint U-Net training, after a 
    training of 100 epochs of GAT-Denoiser alone. }
    \caption{Small scale experiment: GAT-Denoiser components vs. baseline algorithms.}
    \label{tab:small_gat_components}
  \end{table}


\section{Small Scale Experiment: further k-NN Results}
K-NN experiments have been computed before the one with GAT parameter for layers and heads.
The best value for GAT parameters have been 2 layers and 4 heads.
Therefore, k-NN experiment have been repeated with these settings and results 
can be found in Table~\ref{tab:small_knn_2}. 

The outcome was almost the same 

\begin{table}[H]
  \centering
  \begin{tabular}{l|cc}
    \toprule
    \textbf{k} & \multicolumn{2}{l|}{\snrh{ 0}}   \\
                       & \textbf{Loss} & \textbf{SNR}  \\ 
    \midrule
    2    & 9.90 & 601.38  \\ \hline
    4    & 9.64 & 622.13  \\ \hline
    6    & 9.38 & 634.44  \\ \hline
    8    & 9.19 & 648.97  \\ \hline
    \midrule
  \end{tabular}

  \caption{Different k values for \snry 0 dB and -10 dB }
  \label{tab:small_knn_2}
\end{table}


\section{Small Scale Experiment: GAT dropout}
Table~\ref{tab:small_dropout} presents results for experiments with different dropout values.
Further, GAT was defined with 2 layers and 4 heads and convolution with kernel size 3 and padding 1.
\snry is defined with -5 dB and training was without U-Net.

\begin{table}[H]
  \centering
  \begin{tabular}{l|cc}
    \toprule
    \textbf{GAT dropout.} & \multicolumn{2}{l|}{\snrh{ 0}}   \\
                       & \textbf{Loss} & \textbf{SNR}  \\ 
    \midrule
    0       & 8.33 & 739.5  \\ \hline
    0.01    & 7.81 & 766.2  \\ \hline
    0.03    & 7.98 & 743.3  \\ \hline
    0.05    & 8.09 & 738.4  \\ \hline
    0.1     & 7.79 & 761.8  \\ 
    \midrule
  \end{tabular}

  \caption{Different k-NN values for \snry 0 dB and -10 dB }
  \label{tab:small_dropout}
\end{table}

\section{Large scale experiment: baseline results}
Table~\ref{tab:baseline-large} presents the result of the chosen baseline algorithms
for the large scale experiment.

\begin{table}[H]
  \centering
  \begin{tabular}{l|cc|cc|cc|cc}
    \toprule
    \textbf{Algorithm} & \multicolumn{2}{l|}{\snrh{ 0}} & \multicolumn{2}{l|}{\snrh{ -5}} & \multicolumn{2}{l|}{\snrh{ -10}} & \multicolumn{2}{l}{\snrh{ -15}} \\
                       & \textbf{Loss} & \textbf{SNR} & \textbf{Loss} & \textbf{SNR} & \textbf{Loss} & \textbf{SNR} & \textbf{Loss} & \textbf{SNR} \\ 
    \midrule
    FBP                 & 4.57  & 1167.6 & -0.19 & 1973.5 & -5.17 & 3425.3 & -10.09 & 10'737.3       \\ \hline
    BM3D sino           & 9.93  & 709.9  &  7.40 & 890.6  & 4.61  & 1168.0 & 2.09   & 1570.0 \\ \hline
    BM3D reco           & 10.85 & 658.2  & 8.15  & 818.6  & 5.07  & 1118.3 & 1.76   & 1662.5 \\ \hline
    U-Net               & 7.18  &  968.8 & 6.34  & 1044.7 & 4.50  & 1214.1 & 1.94   & 1522.4        \\ 
    \midrule
  \end{tabular}
  \caption{Baseline results large experiments}
  \label{tab:baseline-large}
\end{table}

\subsection{Large Scale experiment: GAT-Denoiser Models}
Table~\ref{tab:large_gat_components_knn2} presents the final results for baseline algorithms
and GAT-Denoiser models for the large scale. 

\begin{table}[H]
    \centering
    \begin{tabular}{l|c|c|c|c}
      \toprule
      \textbf{Algorithm} & \snrh{ 0} & \snrh{ -5} & \snrh{ -10} & \snrh{ -15} \\
                         & \textbf{SNR} & \textbf{SNR} & \textbf{SNR}  & \textbf{SNR} \\ 
      \midrule
      FBP                 & 4.57   & -0.19  & -5.17  & -10.09 \\ \hline
      BM3D sino           & 9.93   &  7.40  & 4.61   & \textbf{2.09}   \\ \hline
      BM3D reco           & \textbf{10.85}  & \textbf{8.15}   & \textbf{5.07}   & 1.76   \\ \hline
      U-Net               & 7.18   & 6.34   & 4.50   & 1.94   \\ 
      \midrule
      \multicolumn{5}{c}{K-NN k = 2} \\
    
        GAT              & 9.36	& 7.89	& 6.64	& 5.32    \\ \hline
        Conv+GAT         &	10.05	& 9.07	& 7.17	& 6.15    \\ \hline
        GAT+U-Net        &	8.39 	& 7.49	& 6.60	& 5.66    \\ \hline
        GAT+U-Net**      &	13.34	& 12.07	& \textbf{11.46}	& \textbf{9.62}   \\ \hline
        Conv+GAT+U-Net   &	8.31	& 7.47	&6.66	  & 5.15   \\ \hline
        Conv+GAT+U-Net** &	\textbf{13.43}	& \textbf{12.52}	& 11.43	& 9.55   \\ 
    \end{tabular}
  
    \caption{Large scale experiment: overall GAT-Denoiser components vs. Baseline for k-NN = 2}
    \label{tab:large_gat_components_knn2}
  \end{table}

\section{Large Scale Experiments: Visual Results}
\label{sec:large_scale_visual_results}
In this section, further visual results for the large scale experiment are presented for 
\snry 0 dB, -5 dB, -10 dB and -15 dB.
Clean images are repeated at every subsection, even tough they are the same

\subsection{\snry 0 dB}
\visualresults{0}

\clearpage

\subsection{\snry -5 dB}
\visualresults{-5}

\clearpage

\subsection{\snry -10 dB}
\visualresults{-10}

\clearpage
\subsection{\snry -15 dB}
\visualresults{-15}


\section{Wandb Results}
Table~\ref{tab:wandb_results} shows urls raw wandb results for all computed experiments on the LoDoPaB-CT dataset.
\begin{table}[H]
  \centering
  \begin{tabular}{l|l}
    \toprule
    \textbf{Experiments} & \textbf{URL} \\ 
    \midrule
    \multicolumn{2}{c}{Small scale experiments:} \\
    FBP & \url{https://wandb.ai/cedric-mendelin/FBP-Validation-LoDoPaB-small} \\ \hline
    BM3D & \url{https://wandb.ai/cedric-mendelin/BM3D-Validation-LoDoPaB-small} \\ \hline
    U-Net& \url{https://wandb.ai/cedric-mendelin/U-Net-Validation-LoDoPaB-small} \\ \hline
    K-nn &\url{https://wandb.ai/cedric-mendelin/LoDoPaB-Small-k-NN-and-graph-size} \\ \hline
    Convolution & \url{https://wandb.ai/cedric-mendelin/LoDoPaB-Small-Convolution} \\ \hline
    Loss& \url{https://wandb.ai/cedric-mendelin/LoDoPaB-Small-Loss-FBP-vs-SINO} \\ \hline
    GAT dropout& \url{https://wandb.ai/cedric-mendelin/LoDoPaB-Small-GAT-dropout} \\ \hline
    GAT-Denoiser $k=2$ & \url{https://wandb.ai/cedric-mendelin/LoDoPaB-Small-Components-knn-2} \\ \hline
    GAT-Denoiser $k=8$ & \url{https://wandb.ai/cedric-mendelin/LoDoPaB-Small-Components-knn-8} \\ \hline
    \midrule
    \multicolumn{2}{c}{Large scale experiments:} \\
    U-NET & \url{https://wandb.ai/cedric-mendelin/U-Net-Validation-LoDoPaB-large} \\ \hline
    FBP& \url{https://wandb.ai/cedric-mendelin/FBP-Validation-LoDoPaB-large} \\ \hline
    BM3D& \url{https://wandb.ai/cedric-mendelin/BM3D-Validation-LoDoPaB-large} \\ \hline
    GAT-Denoiser & \url{https://wandb.ai/cedric-mendelin/LoDoPaB-Large-knn-2} \\ \hline

  \end{tabular}
  \caption{Wandb raw results.}
  \label{tab:wandb_results}
\end{table}

\paragraph{Average wandb run result:}
Average SNR and loss have been computed with a python script and exported values can be found under\footnote{https://github.com/cedricmendelin/master-thesis/tree/main/wandb\_results}.
